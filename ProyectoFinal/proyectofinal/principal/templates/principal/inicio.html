{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lerigr Watches</title>
<link rel="stylesheet" href="{% static 'stylesInicio.css' %}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>
<!-- Header -->
<header>
    <div class="logo">LOGO</div>
    <nav>
    <ul>
        <li><a href="#">Inicio</a></li>
        <li><a href="#">Productos</a></li>
        <li><a href="{% url 'ver_wishlist' %}">Favoritos</a></li>
        <li><a href="#">Contactanos</a></li>
    </ul>
    </nav>
    <div class="icons">
        <a href="#"></a>
        <a href="{% url 'ver_carrito' %}"><img width="30" height="30" src="https://img.icons8.com/glyph-neue/64/shopping-cart.png" alt="shopping-cart"/></a>

    {% if user.is_authenticated %}
        <!-- Submenú del usuario -->
        <div class="user-menu">
            <img id="userIcon" class="user-icon" width="30" height="30" src="https://img.icons8.com/ios-filled/50/user.png" alt="user"/>
            <ul id="userDropdown" class="dropdown">
                <li><a href="#">Perfil</a></li>
                <li><a href="{% url 'logout' %}">Cerrar sesión</a></li>
            </ul>
        </div>
    {% else %}
        <!-- Si no hay sesión -->
        <a href="{% url 'login' %}">
            <img width="30" height="30" src="https://img.icons8.com/ios-filled/50/user.png" alt="user"/>
        </a>
    {% endif %}

    </div>
</header>

<!-- Hero -->


<!-- Carrusel -->
<!-- Carrusel de últimos 3 productos -->
<div id="carouselProductos" class="carousel slide custom-carousel" data-bs-ride="carousel">
  <div class="carousel-inner">

    {% for p in productos_carrusel %}
      <div class="carousel-item {% if forloop.first %}active{% endif %}">
        {% if p.foto %}
          <img src="{{ p.foto.url }}" class="d-block w-100 carousel-img" alt="{{ p.nombre }}">
        {% else %}
          <img src="{% static 'img/default.jpg' %}" class="d-block w-100 carousel-img" alt="{{ p.nombre }}">
        {% endif %}
        
        <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded p-2">
          <h5>{{ p.nombre }}</h5>
          <p>${{ p.precio }}</p>
          <form action="{% url 'agregar_al_carrito' p.id %}" method="POST">
            {% csrf_token %}
            <button type="submit" class="btn">Agregar al carrito</button>
          </form>
        </div>
      </div>
    {% endfor %}

  </div>

  <!-- Controles -->
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselProductos" data-bs-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselProductos" data-bs-slide="next">
    <span class="carousel-control-next-icon"></span>
  </button>
</div>


<!-- Categories -->




<!-- Featured Products -->
<section class="products">
    <h2>Productos agregados</h2>
    <div class="product-list">
        {% for p in productos_lista %}
            <div class="product">
              <div class="producto-imagen-container">
                {% if p.foto %}
                    <img src="{{ p.foto.url }}" alt="{{ p.nombre }}">
                {% else %}
                    <img src="{% static 'img/default.jpg' %}" alt="{{ p.nombre }}">
                {% endif %}

                {% if user.is_authenticated %}
                    <button 
                      type="button"
                      class="btn-favorite btn-wishlist-toggle"
                      data-id="{{ p.id }}"
                      aria-pressed="{{ p.en_wishlist|yesno:'true,false' }}">
                      ❤️
                    </button>
                {% else %}
                    <a href="{% url 'login' %}" class="btn-favorite">
                        ❤️
                    </a>
                {% endif %}
              </div>

              <p>{{ p.nombre }}</p>
              <span>${{ p.precio }}</span>

              <form action="{% url 'agregar_al_carrito' p.id %}" method="POST" class="form-agregar-carrito mt-2">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-primary btn-sm">
                      Agregar al carrito
                  </button>
              </form>
            </div>


        {% empty %}
            <p>No hay productos aún.</p>
        {% endfor %}
    </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>


<!-- Footer -->
<footer>
    <p>Sobre nosotros | Contacto | Locales</p>
    <div class="socials">
        <a href="#">Facebook</a>
        <a href="#">Instagram</a>
        <a href="#">Twitter</a>
    </div>
</footer>
<script src="{% static 'submenulogin.js' %}"></script>
<script src="{% static 'carritoInicio.js' %}"></script>
<script src="{% static 'wishlist.js' %}"></script>
<script src="{% static 'wishlist-toggle.js' %}"></script>


</body>
</html>


